<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Data Detectives</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="index.html" class="logo"><strong>Data Detectives</strong></a>
									<!-- <ul class="icons">
										<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
										<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
										<li><a href="#" class="icon brands fa-snapchat-ghost"><span class="label">Snapchat</span></a></li>
										<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
										<li><a href="#" class="icon brands fa-medium-m"><span class="label">Medium</span></a></li>
									</ul> -->
								</header>

							<!-- Banner -->
								<section>
									<div class="content">
										<header>
											<h2>Level 2 - Are All Models Equal?</h2> 
										</header>
										<div class="box">
											<p>Ok, so you've come back because something didn't quite smell right. "I have to spend 100 hours on data detectives to get an almost-but-not-even-perfect score? AND I have to go to class for an hour?" What a keen nose you have! I tried to pull a fast one on you and said that our end-to-end supervised modeling pipeline looked like this:
											</p>
											<p><a href="#" class="image"><img src="images/modeling_pipeline_1.png" alt="" /></a>
											</p>
											<p>And while that's not technically wrong, it's definitely not best practice either. Sure, you can get a model out in the few lines of code provided, but...how good is it? Does it actually work? Can I trust it? Should I be using it to make decisions? <i>Data-driven</i> decisions?
											</p>
											<p>Unfortunately, probably not. We need to add a few more pieces first, and the first piece is the concept of a <strong>holdout set</strong>. If we have data, we want to be able to use it efficiently, which doesn't always mean using all of it to train a model. Instead, we want to be able to use part of it to tell us how well our model might perform, <i>in the real world</i>. The underlying principle (and assumption!) is this: if the real world created the data right in front of you, then if you use your model to predict a portion of that data, you can get a sense for how it would actually perform in the real world. So we intentionally choose to <i>hold out</i> a portion (or set) of our data to <i>test</i> our model, and get a sense for how it might actually perform. We use a portion of the data to train (though in actuality you can use whatever you want to train, as long as it has the same features), and a portion to test our trained model, giving us the fabled <strong>train-test split</strong> (don't even get me started on cross-validation!).
											</p>
											<p>Adding in this concept then makes our pipeline look like this:
											</p>
											<p><a href="#" class="image"><img src="images/modeling_pipeline_2.png" alt="" /></a>
											</p>
											<p>Now we're talking. But wait, how do we compare the predictions coming out of our model from the holdout set features with the holdout set target? Well, we need some kind of metric or measure that tells us how close they are. There are, in fact, many different kinds of metrics for different kinds of predictions that tell us different things. For example, in classification, accuracy tells us something different than an F1 score, which is still different from average precision, precision-recall, etc. For the sake of our example, we'll use a mean squared error metric, meaning the sum of the squares of the differences between each prediction and target value. Ok, now I think we're ready.
											</p>
											<p><a href="#" class="image"><img src="images/modeling_pipeline_3.png" alt="" /></a>
											</p>
										</div>
										<div class="box">
											<p>So let's do some coding and figure out which model we fit is going to be our best one, and probably perform the best in real life. We'll train a few models on the training data, and then use those models on our holdout set to see which has the minimum mean squared error (MSE).
											</p>
											<p>To do this, let's first generate some <i>real, fake data</i>. <pre><code>import math
import numpy as np
import pandas as pd

n_samples = 10000
np.random.seed(1019)

target = pd.DataFrame({
	"final_exam_score": list(np.random.randint(0, 100, n_samples)),
})

features = pd.DataFrame({
	"hours_spent_in_class": list(np.random.randint(0, 20, n_samples)),
	"hours_spent_on_data_detectives": [
		x - min(target["final_exam_score"].tolist()) + np.random.randint(-50, 50, 1)[0]
		for x in target["final_exam_score"].tolist()
	],
	"year_in_school": [
		math.ceil(np.random.sample() * 4) for i in range(n_samples)
	],
	"gpa_prior_years": [
		np.random.sample() * 4 for i in range(n_samples)
	],
	"avg_bobas_purchased_per_week": [
		math.ceil(np.random.sample() * 7) for i in range(n_samples)
	]
})</code></pre>
											</p>
											<p>Then, we'll split the data into a train portion and a test portion so that we can have a holdout set. <pre><code>target_train = target.iloc[:int(0.7 * target.shape[0])]
target_test = target.iloc[int(0.7 * target.shape[0]):]

features_train = features.iloc[:int(0.7 * features.shape[0])]
features_test = features.iloc[int(0.7 * features.shape[0]):]</code></pre>
											</p>
											<p>We'll train a few models. <pre><code>from sklearn.ensemble import RandomForestRegressor
from sklearn.linear_model import LinearRegression
from xgboost import XGBRegressor

fun_models = [
	LinearRegression(),
] + [
	RandomForestRegressor(n_jobs=-1, random_state=i) for i in range(1, 10)
] + [
	XGBRegressor(n_jobs=-1, random_state=i) for i in range(1, 10)
]

for model in fun_models:
	model.fit(features_train, target_train)</code></pre>
											</p>
											<p>And finally, we'll see which one was the best! <pre><code>from sklearn.metrics import mean_squared_error

mse_scores = []
for model in fun_models:
	mse = mean_squared_error(
		target_test,
		model.predict(features_test),
	)
	mse_scores.append(mse)

best_model = sorted(list(zip(fun_models, mse_scores)), key=lambda x: x[1])[0]</code></pre>
											</p>
										</div>
										<div class="box">
											<p>So which one won?</p>
											<p>Hopefully it's clear now that with this set up, we can start to compare between models; and, even more than that, we can start to get a sense for how our best model might perform in a real world scenario. From there, we can start making data-driven decisions based on the data we have at hand, and the expected impact we can calculate from different features.</p>
										</div>
									</div>
								</section>

							<!-- Section -->
								<!-- <section>
									<header class="major">
										<h2>Erat lacinia</h2>
									</header>
									<div class="features">
										<article>
											<span class="icon fa-gem"></span>
											<div class="content">
												<h3>Portitor ullamcorper</h3>
												<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
											</div>
										</article>
										<article>
											<span class="icon solid fa-paper-plane"></span>
											<div class="content">
												<h3>Sapien veroeros</h3>
												<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
											</div>
										</article>
										<article>
											<span class="icon solid fa-rocket"></span>
											<div class="content">
												<h3>Quam lorem ipsum</h3>
												<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
											</div>
										</article>
										<article>
											<span class="icon solid fa-signal"></span>
											<div class="content">
												<h3>Sed magna finibus</h3>
												<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
											</div>
										</article>
									</div>
								</section> -->

							<!-- Section -->
								<!-- <section>
									<header class="major">
										<h2>Ipsum sed dolor</h2>
									</header>
									<div class="posts">
										<article>
											<a href="#" class="image"><img src="images/pic01.jpg" alt="" /></a>
											<h3>Interdum aenean</h3>
											<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
											<ul class="actions">
												<li><a href="#" class="button">More</a></li>
											</ul>
										</article>
										<article>
											<a href="#" class="image"><img src="images/pic02.jpg" alt="" /></a>
											<h3>Nulla amet dolore</h3>
											<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
											<ul class="actions">
												<li><a href="#" class="button">More</a></li>
											</ul>
										</article>
										<article>
											<a href="#" class="image"><img src="images/pic03.jpg" alt="" /></a>
											<h3>Tempus ullamcorper</h3>
											<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
											<ul class="actions">
												<li><a href="#" class="button">More</a></li>
											</ul>
										</article>
										<article>
											<a href="#" class="image"><img src="images/pic04.jpg" alt="" /></a>
											<h3>Sed etiam facilis</h3>
											<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
											<ul class="actions">
												<li><a href="#" class="button">More</a></li>
											</ul>
										</article>
										<article>
											<a href="#" class="image"><img src="images/pic05.jpg" alt="" /></a>
											<h3>Feugiat lorem aenean</h3>
											<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
											<ul class="actions">
												<li><a href="#" class="button">More</a></li>
											</ul>
										</article>
										<article>
											<a href="#" class="image"><img src="images/pic06.jpg" alt="" /></a>
											<h3>Amet varius aliquam</h3>
											<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
											<ul class="actions">
												<li><a href="#" class="button">More</a></li>
											</ul>
										</article>
									</div>
								</section> -->

						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">

							<!-- Search -->
								<section id="search" class="alt">
									<form method="post" action="#">
										<input type="text" name="query" id="query" placeholder="Search" />
									</form>
								</section>

							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="index.html">Home</a></li>
										<li><a href="about.html">About</a></li>
										<li>
											<span class="opener">An End to End Supervised Modeling Pipeline</span>
											<ul>
												<li><a href="an_end_to_end_modeling_pipeline.html">Overview</a></li>
												<li><a href="e2e_modeling_level1.html">Level 1</a></li>
												<li><a href="e2e_modeling_level2.html">Level 2</a></li>
												<li><a href="e2e_modeling_level3.html">Level 3</a></li>
											</ul>
										</li>
									</ul>
								</nav>

							<!-- Section -->
								<!-- <section>
									<header class="major">
										<h2>Ante interdum</h2>
									</header>
									<div class="mini-posts">
										<article>
											<a href="#" class="image"><img src="images/pic07.jpg" alt="" /></a>
											<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore aliquam.</p>
										</article>
										<article>
											<a href="#" class="image"><img src="images/pic08.jpg" alt="" /></a>
											<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore aliquam.</p>
										</article>
										<article>
											<a href="#" class="image"><img src="images/pic09.jpg" alt="" /></a>
											<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore aliquam.</p>
										</article>
									</div>
									<ul class="actions">
										<li><a href="#" class="button">More</a></li>
									</ul>
								</section> -->

							<!-- Section -->
								<!-- <section>
									<header class="major">
										<h2>Get in touch</h2>
									</header>
									<p>Sed varius enim lorem ullamcorper dolore aliquam aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin sed aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
									<ul class="contact">
										<li class="icon solid fa-envelope"><a href="#">information@untitled.tld</a></li>
										<li class="icon solid fa-phone">(000) 000-0000</li>
										<li class="icon solid fa-home">1234 Somewhere Road #8254<br />
										Nashville, TN 00000-0000</li>
									</ul>
								</section> -->

							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">&copy; Data Detectives, LLC. All rights reserved. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
								</footer>

						</div>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>